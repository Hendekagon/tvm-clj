<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tvm-clj.application.kmeans documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">tvm-clj</span> <span class="project-version">6.00-beta-1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="background.html"><div class="inner"><span>Technical Background</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tvm-clj</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>application</span></div></div></li><li class="depth-3 branch"><a href="tvm-clj.application.image.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>image</span></div></a></li><li class="depth-3 current"><a href="tvm-clj.application.kmeans.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kmeans</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.ast.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>ast</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.compiler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compiler</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.device.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>device</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.module.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>module</span></div></a></li><li class="depth-2"><a href="tvm-clj.schedule.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schedule</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tvm-clj.application.kmeans.html#var-kmeans.2B.2B"><div class="inner"><span>kmeans++</span></div></a></li><li class="depth-1"><a href="tvm-clj.application.kmeans.html#var-order-data-labels"><div class="inner"><span>order-data-labels</span></div></a></li><li class="depth-1"><a href="tvm-clj.application.kmeans.html#var-predict-per-label"><div class="inner"><span>predict-per-label</span></div></a></li><li class="depth-1"><a href="tvm-clj.application.kmeans.html#var-quantize-image"><div class="inner"><span>quantize-image</span></div></a></li><li class="depth-1"><a href="tvm-clj.application.kmeans.html#var-train-per-label"><div class="inner"><span>train-per-label</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tvm-clj.application.kmeans</h1><div class="doc"><div class="markdown"><p>High performance implementation of the KMeans algorithm using kmeans++ initialization and Lloydâ€™s algorithm for convergence.</p></div></div><div class="public anchor" id="var-kmeans.2B.2B"><h3>kmeans++</h3><div class="usage"><code>(kmeans++ dataset n-centroids &amp; [{:keys [n-iters rand-seed minimal-improvement-threshold], :or {minimal-improvement-threshold 0.01}, :as options}])</code></div><div class="doc"><div class="markdown"><p>Find K cluster centroids via kmeans++ center initialization followed by Lloyds algorithm. Dataset must be a matrix (2d tensor).</p>
<ul>
  <li><code>dataset</code> - 2d matrix of numeric datatype.</li>
  <li><code>n-centroids</code> - How many centroids to find.</li>
</ul>
<p>Returns map of:</p>
<ul>
  <li><code>:centroids</code> - 2d tensor of double centroids</li>
  <li><code>:centroid-indexes</code> - 1d integer vector of assigned center indexes.</li>
  <li><code>:iteration-scores</code> - n-iters+1 length array of mean squared error scores container  the scores from centroid assigned up to the score when the algorithm  terminates.</li>
</ul>
<p>Options:</p>
<ul>
  <li><code>:minimal-improvement-threshold</code> - defaults to 0.01 - algorithm terminates if  (1.0 - error(n-1)/error(n-2)) &lt; error-diff-threshold. When Zero means algorithm will  always train to max-iters.</li>
  <li><code>:n-iters</code> - defaults to 100 - Max number of iterations, algorithm terminates  if `(&gt;= iter-idx n-iters).</li>
  <li><code>:rand-seed</code> - integer or implementation of <code>java.util.Random</code>.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/application/kmeans.clj#L551">view source</a></div></div><div class="public anchor" id="var-order-data-labels"><h3>order-data-labels</h3><div class="usage"><code>(order-data-labels data labels)</code></div><div class="doc"><div class="markdown"><p>Order the dataset and labels such that labels are monotonically increasing. returns tuple of [dataset labels]</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/application/kmeans.clj#L701">view source</a></div></div><div class="public anchor" id="var-predict-per-label"><h3>predict-per-label</h3><div class="usage"><code>(predict-per-label data model)</code></div><div class="doc"><div class="markdown"><p>Return both a probability distribution per row across each label and a 1d tensor of assigned label indexes.</p>
<p>Returns:</p>
<ul>
  <li><code>:probability-distribution</code> - each row sums to one, max prob is the index picked.</li>
  <li><code>:label-indexes</code> - int32 assigned indexes for each row in the dataset.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/application/kmeans.clj#L824">view source</a></div></div><div class="public anchor" id="var-quantize-image"><h3>quantize-image</h3><div class="usage"><code>(quantize-image src-path dst-path n-quantization &amp; [{:keys [n-iters seed], :or {n-iters 5}}])</code></div><div class="doc"><div class="markdown"><p>Quantize an image using kmeans. Copies data into a new image and, if dest-path is provided, saves the image.</p>
<p>Returns:</p>
<ul>
  <li><code>:centroids</code> - result of the quantization.</li>
  <li><code>:result</code> - resulting BufferedImage.</li>
  <li><code>:scores</code> - Scores after each iteration including initialization.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/application/kmeans.clj#L898">view source</a></div></div><div class="public anchor" id="var-train-per-label"><h3>train-per-label</h3><div class="usage"><code>(train-per-label data labels n-per-label &amp; [{:keys [input-ordered?], :as options}])</code></div><div class="doc"><div class="markdown"><p>Given a dataset along with per-row integer labels, train N per-label kmeans centroids returning a model which you can use can use with predict-per-label.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/application/kmeans.clj#L719">view source</a></div></div></div></body></html>